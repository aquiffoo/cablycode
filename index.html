<!DOCTYPE html>
<html>

<head>
    <title>CablyCode</title>
    <link href="themes.css" rel="stylesheet" type="text/css">
    <link href="style.css" rel="stylesheet" type="text/css">
</head>

<body>
    <!-- Add this right after the <body> tag, before any other content -->
    <div class="spinner-overlay" style="display: flex;">
        <div class="spinner"></div>
        <div class="spinner-message">Loading editor...</div>
    </div>

    <div id="container">
        <div id="titlebar">
            <span>CablyCode</span>
            <div id="window-controls">
                <div class="window-control-button" id="minimize-button">&#8211;</div>
                <div class="window-control-button" id="maximize-button">&#9633;</div>
                <div class="window-control-button" id="close-button">&#10005;</div>
            </div>
        </div>
        <div id="menubar">
            <div class="menu-item">
                <span>File</span>
                <div class="menu-dropdown">
                    <div class="menu-option">New Window</div>
                    <div class="menu-separator"></div>
                    <div class="menu-option">New File</div>
                    <div class="menu-option">Open File...</div>
                    <div class="menu-option">Open Folder...</div>
                    <div class="menu-separator"></div>
                    <div class="menu-option">Save</div>
                    <div class="menu-option">Save As...</div>
                    <div class="menu-separator"></div>
                    <div class="menu-option">Exit</div>
                </div>
            </div>
            <!-- Add this to your menubar, after the File menu -->
            <div class="menu-item">
                <span>Settings</span>
                <div class="menu-dropdown">
                    <div class="menu-option" id="set-api-key">AI Settings</div>
                    <div class="menu-option" id="set-editor-settings">Editor Settings</div>

                </div>
            </div>
            <!-- Add this after the Settings menu item in the menubar -->
            <div class="menu-item">
                <span>View</span>
                <div class="menu-dropdown">
                    <div class="menu-option" id="toggle-sidebar">
                        Show Sidebar <span id="sidebar-tick" class="tick" style="display: inline;">&#10003;</span>
                    </div>
                    <div class="menu-option" id="toggle-minimap">
                        Show Minimap <span id="minimap-tick" class="tick" style="display: inline;">&#10003;</span>
                    </div>
                    <div class="menu-separator"></div>
                    <div class="menu-option has-submenu">
                        <span>Theme</span>
                        <div class="submenu" id="theme-menu">
                            <!-- Theme options will be added here dynamically -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- Add this to the menubar div, after the Settings menu -->
            <div class="menu-item" style="margin-left: auto;">
                <span id="ai-chat-button" style="cursor: pointer;">AI Chat</span>
            </div>
        </div>
        <div id="main-content">
            <div id="side-bar">
                <div class="side-bar-item active" id="explorer-icon" title="Explorer">
                    <svg class="side-bar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 3h18v18H3zM3 9h18M9 21V9" />
                    </svg>
                </div>
                <div class="side-bar-item" id="search-icon" title="Search">
                    <svg class="side-bar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8" />
                        <line x1="21" y1="21" x2="16.65" y2="16.65" />
                    </svg>
                </div>
            </div>
            <div id="sidebar">
                <div class="explorer-title">EXPLORER</div>
                <div id="file-explorer"></div>
                <div id="search-container">
                    <div class="search-input-container">
                        <div class="search-status" id="search-status" style="display: none; color: #999; padding: 5px;">
                            Searching...
                        </div>
                        <input type="text" class="search-input" id="search-input" placeholder="Search in files...">
                    </div>
                    <div class="search-results" id="search-results"></div>
                </div>
            </div>
            <div id="editor-container">
                <div id="tabs-container"></div>
                <div id="file-path-bar"></div>
                <div id="editor"></div>
            </div>
        </div>
        <div id="context-menu" class="context-menu" style="display: none;"></div>
        <!-- Add this toast notification div after your context-menu div -->
        <div id="toast" style="display: none; position: fixed; bottom: 20px; right: 20px; 
            background: var(--sidebar-background-color); color: var(--text-color); padding: 12px 24px; border-radius: 4px; 
            z-index: 1000; box-shadow: 0 2px 8px rgba(0,0,0,0.35);">
        </div>
    </div>

    <div class="spinner-overlay">
        <div class="spinner"></div>
        <div class="spinner-message">Loading...</div>
    </div>

    <!-- Add chat modal HTML here, before scripts -->
    <div class="chat-modal" id="chat-modal">
        <div class="chat-header">
            <span class="chat-header-title">AI Chat</span>
            <span class="chat-close" id="chat-close">Ã—</span>
        </div>
        <div class="chat-file-selector" id="chat-file-list">
            <!-- Files will be added here dynamically -->
        </div>
        <div class="chat-messages" id="chat-messages"></div>
        <div class="chat-input-container">
            <textarea
                class="chat-input"
                id="chat-input"
                placeholder="Type your message..."
                rows="1"
            ></textarea>
            <button class="chat-send" id="chat-send">Send</button>
        </div>
    </div>

    <!-- API key modal -->
    <div class="modal-overlay" id="api-key-modal">
        <div class="modal">
            <div class="modal-header">AI Settings</div>
            <div class="modal-content">
                <input type="password"
                    id="api-key-input"
                    class="modal-input"
                    placeholder="Enter your API key"
                    style="width: 350px; font-family: monospace;">
                <br>
                <label for="model-select">Select AI Model:</label>
                <select id="model-select" class="modal-input" style="width: 350px;">
                    <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                    <option value="gpt-4o-mini">GPT-4o Mini</option>
                    <option value="gpt-4">GPT-4</option>
                </select>
            </div>
            <div class="modal-buttons">
                <button class="modal-button cancel" id="cancel-api-key">Cancel</button>
                <button class="modal-button" id="save-api-key">Save</button>
            </div>
        </div>
    </div>

    <!-- Editor Settings Modal -->
    <div class="modal-overlay" id="editor-settings-modal">
        <div class="modal">
            <div class="modal-header">Editor Settings</div>
            <div class="modal-content">
                <label for="font-size-select">Font Size:</label>
                <select id="font-size-select" class="modal-input" style="width: 350px;">
                    <option value="10">10px</option>
                    <option value="12">12px</option>
                    <option value="14">14px</option>
                    <option value="16">16px</option>
                    <option value="18">18px</option>
                    <option value="20">20px</option>
                    <option value="22">22px</option>
                </select>
                <br>
                <label for="line-height-select">Line Height:</label>
                <select id="line-height-select" class="modal-input" style="width: 350px;">
                    <option value="1.2">1.2</option>
                    <option value="1.4">1.4</option>
                    <option value="1.6">1.6</option>
                </select>
            </div>
            <div class="modal-buttons">
                <button class="modal-button cancel" id="cancel-editor-settings">Cancel</button>
                <button class="modal-button" id="save-editor-settings">Save</button>
            </div>
        </div>
    </div>

    <!-- Then start the scripts -->
    <script>
        // Add these requires at the top with other electron requires
        const electron = require('electron');
        const remote = electron.remote;
        const fs = remote.require('fs');
        const path = remote.require('path');
        const hljs = require('highlight.js');  // Add this
        const marked = require('marked');      // Add this

        // Store these in global scope for use later
        window.electronFS = fs;
        window.electronPath = path;
        window.electronRemote = remote;
        window.hljs = hljs;                   // Add this
        window.marked = marked;               // Add this
    </script>

    <script src="public/vs/loader.js"></script>
    <script src="script.js"></script>
</body>

</html>